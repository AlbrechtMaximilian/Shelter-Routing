import gurobipy as gp
from gurobipy import GRB
import time
import math

def solve_routing(S, V,
                  distance, demand,
                  capacity, speed,
                  unload_t):
    """
    S: iterable of nodes (0 = depot)
    V: iterable of vehicles
    T: iterable of trips per vehicle
    distance: dict[(i,j)]→km
    demand: dict[i]→tons (i≠0)
    capacity: max tons/trip
    speed: km/h
    unload_t: min to unload 1 ton
    Tmax: max minutes/trip
    """

    launch_cost = 100
    # calculate T
    # calculate wors-case trip number
    D = sum(demand[i] for i in S if i != 0)  # total demand
    T_max = math.ceil(D / (capacity * len(V)))  # worst-case trips
    T = range(T_max)
    print("maximum number of trips needed: " + str(T_max))

    # start gurobi
    m = gp.Model()
    # Vars
    x = m.addVars(S, S, V, T, vtype=GRB.BINARY)
    q = m.addVars(S, V, T, vtype=GRB.CONTINUOUS, lb=0)
    u = m.addVars(S, V, T, vtype=GRB.CONTINUOUS, lb=0, ub=len(S)-1)
    # Obj
    drive_time = gp.quicksum((distance[i, j] / speed) * 60 * x[i, j, v, t]
                             for i in S for j in S if i != j
                             for v in V for t in T)

    unload_time = gp.quicksum(unload_t * q[i, v, t]
                              for i in S if i != 0
                              for v in V for t in T)

    launch_ind = gp.quicksum(x[0, j, v, t]  # arc 0→j exists ⇒ trip is dispatched
                             for j in S if j != 0
                             for v in V for t in T)

    m.setObjective(drive_time + unload_time + launch_cost * launch_ind,
                   GRB.MINIMIZE)
    # 1) start/end at 0
    for v in V:
        for t in T:
            m.addConstr(sum(x[0,j,v,t] for j in S if j!=0)==1)
            m.addConstr(sum(x[j,0,v,t] for j in S if j!=0)==1)
    # 2) flow conservation
    for v in V:
        for t in T:
            for k in S:
                if k!=0:
                    m.addConstr(
                        sum(x[i,k,v,t] for i in S if i!=k)
                        == sum(x[k,j,v,t] for j in S if j!=k)
                    )
    # 3) capacity & demand
    for v in V:
        for t in T:
            m.addConstr(sum(q[i,v,t] for i in S if i!=0) <= capacity)
            for i in S:
                if i!=0:
                    m.addConstr(q[i,v,t] <= capacity *
                                sum(x[j,i,v,t] for j in S if j!=i))
                    m.addConstr(q[i, v, t] <= demand[i])
    for i in S:
        if i!=0:
            m.addConstr(sum(q[i,v,t] for v in V for t in T)==demand[i])
    """# 4) time limit
    for v in V:
        for t in T:
            drive = sum((distance[i,j]/speed)*60 * x[i,j,v,t]
                        for i in S for j in S if i!=j)
            unload = sum(unload_t * q[i,v,t] for i in S if i!=0)
            m.addConstr(drive + unload <= Tmax)"""
    # 5) MTZ + root
    for v in V:
        for t in T:
            m.addConstr(u[0,v,t]==0)
            for i in S:
                for j in S:
                    if i!=j and i!=0 and j!=0:
                        m.addConstr(u[i,v,t] - u[j,v,t]
                                    + len(S)*x[i,j,v,t]
                                    <= len(S)-1)
    # solve & time
    start = time.time()
    m.params.OutputFlag = 0
    m.optimize()
    runtime = time.time() - start

    # Output
    for v in V:
        for t in T:
            route = []
            for i in S:
                for j in S:
                    if i != j and x[i, j, v, t].X > 0.5:
                        route.append((i, j))
            if route:
                print(f"Vehicle {v}, Trip {t}: Route: {route}")
                for i in S:
                    if i != 0 and q[i, v, t].X > 0:
                        print(f"  Deliver to {i}: {q[i, v, t].X:.2f} tons")

    return m.ObjVal, runtime


if __name__ == "__main__":
    # normal function call
    S = range(6)
    V = range(40)
    """distance = {
        (0,1):10,(1,0):10,(0,2):15,(2,0):15,
        (0,3):20,(3,0):20,(1,2):5, (2,1):5,
        (1,3):10,(3,1):10,(2,3):7, (3,2):7
    }
    demand = {1:2, 2:3, 3:1}"""
    """distance = {(0, 0): 0.0, (0, 1): 1.0, (0, 2): 2.0, (0, 3): 1.0, (0, 4): 1.0, (1, 0): 1.0, (1, 1): 0.0, (1, 2): 3.0,
     (1, 3): 1.0, (1, 4): 1.0, (2, 0): 2.0, (2, 1): 3.0, (2, 2): 0.0, (2, 3): 1.0, (2, 4): 1.0, (3, 0): 1.0,
     (3, 1): 1.0, (3, 2): 1.0, (3, 3): 0.0, (3, 4): 1.0, (4, 0): 1.0, (4, 1): 1.0, (4, 2): 1.0, (4, 3): 1.0,
     (4, 4): 0.0}
    demand = {1: 1.0, 2: 2.0, 3: 2.0, 4: 2.0}"""
    demand = {1: 28.0, 2: 28.0, 3: 30.0, 4: 20.0, 5: 36.0, 6: 10.0, 7: 24.0, 8: 35.0, 9: 29.0, 10: 23.0, 11: 33.0, 12: 35.0, 13: 19.0, 14: 21.0, 15: 32.0, 16: 22.0, 17: 11.0, 18: 42.0, 19: 29.0, 20: 44.0, 21: 27.0, 22: 20.0, 23: 31.0, 24: 50.0, 25: 39.0, 26: 42.0, 27: 50.0, 28: 11.0, 29: 26.0, 30: 27.0}
    distance = {(0, 0): 0.0, (0, 1): 60.49198706341025, (0, 2): 33.97693445708452, (0, 3): 88.38190960425572, (0, 4): 28.7310673071466, (0, 5): 81.33346428875116, (0, 6): 58.10325955071855, (0, 7): 24.93349684161967, (0, 8): 35.79225674040955, (0, 9): 20.95720940035056, (0, 10): 44.30693243487325, (0, 11): 35.69656644012649, (0, 12): 54.37986486349558, (0, 13): 41.58352747988214, (0, 14): 63.22608949159894, (0, 15): 49.61131461894087, (0, 16): 20.32108747152227, (0, 17): 75.91772544627725, (0, 18): 73.09188460862043, (0, 19): 88.51962852882119, (0, 20): 91.10283427219564, (0, 21): 76.37125555017094, (0, 22): 82.47895112783064, (0, 23): 11.18417807011642, (0, 24): 31.61093949395119, (0, 25): 28.21843465990575, (0, 26): 85.69355794009749, (0, 27): 29.01611405522948, (0, 28): 61.7892435125685, (0, 29): 86.24514613992763, (0, 30): 33.22160817810058, (1, 0): 60.49198706341025, (1, 1): 0.0, (1, 2): 26.57086183704163, (1, 3): 57.95868109454401, (1, 4): 66.50393564791938, (1, 5): 50.61215312332168, (1, 6): 6.510393152172984, (1, 7): 85.14322756564519, (1, 8): 96.28194984249157, (1, 9): 53.46575007365973, (1, 10): 93.41203045812095, (1, 11): 60.41791506248253, (1, 12): 80.7794167858505, (1, 13): 26.0037326595388, (1, 14): 3.113265329732273, (1, 15): 49.27942909127728, (1, 16): 48.81997083463079, (1, 17): 71.8035872245565, (1, 18): 74.42818489259183, (1, 19): 114.4084915260553, (1, 20): 64.80427715708021, (1, 21): 48.97717343185385, (1, 22): 75.77048647163404, (1, 23): 65.95793143259671, (1, 24): 92.06396367177484, (1, 25): 37.9116173230029, (1, 26): 112.032232254927, (1, 27): 35.1459440568528, (1, 28): 38.02569128225791, (1, 29): 60.52029218105164, (1, 30): 27.40873713416465, (2, 0): 33.97693445708452, (2, 1): 26.57086183704163, (2, 2): 0.0, (2, 3): 67.53977602983836, (2, 4): 44.93571316127846, (2, 5): 59.75665905226485, (2, 6): 24.29447278641767, (2, 7): 58.76768444781924, (2, 8): 69.7453969679159, (2, 9): 29.16439550796777, (2, 10): 70.37462596056518, (2, 11): 42.38364911591653, (2, 12): 64.81288265101328, (2, 13): 16.62296486099018, (2, 14): 29.39014281753258, (2, 15): 40.5504620323308, (2, 16): 24.11199045103866, (2, 17): 68.53018607468915, (2, 18): 68.75419480709326, (2, 19): 100.5523952857347, (2, 20): 72.56664525527324, (2, 21): 55.96514573763716, (2, 22): 74.12790123923762, (2, 23): 40.29203002379723, (2, 24): 65.58342936374734, (2, 25): 14.92068193493168, (2, 26): 97.9058010951774, (2, 27): 11.65422795577537, (2, 28): 41.00424674254285, (2, 29): 67.64471103268659, (2, 30): 1.090121073984672, (3, 0): 88.38190960425572, (3, 1): 57.95868109454401, (3, 2): 67.53977602983836, (3, 3): 0.0, (3, 4): 72.5230688681245, (3, 5): 7.808939171823138, (3, 6): 64.18415489219576, (3, 7): 105.8868772272847, (3, 8): 118.1112172355688, (3, 9): 94.77219584140026, (3, 10): 95.14885933871754, (3, 11): 61.13711280621809, (3, 12): 66.37001665418006, (3, 13): 51.3841511593312, (3, 14): 56.19601264523872, (3, 15): 40.93322771849819, (3, 16): 89.74058376316498, (3, 17): 33.20647507300442, (3, 18): 39.62692574005803, (3, 19): 85.630338167199, (3, 20): 7.686746219382752, (3, 21): 12.06607945067965, (3, 22): 31.82329443713265, (3, 23): 85.98764924591875, (3, 24): 113.2187394620523, (3, 25): 82.3478201218962, (3, 26): 84.33338789243207, (3, 27): 79.11307874919765, (3, 28): 27.20319516227938, (3, 29): 6.311779922945139, (3, 30): 68.58100384198583, (4, 0): 28.7310673071466, (4, 1): 66.50393564791938, (4, 2): 44.93571316127846, (4, 3): 72.5230688681245, (4, 4): 0.0, (4, 5): 66.88422981675282, (4, 6): 66.95379107387645, (4, 7): 34.89101542556325, (4, 8): 46.61117202995924, (4, 9): 48.00461574043358, (4, 10): 27.19010482767081, (4, 11): 11.42793537692121, (4, 12): 25.64927984944411, (4, 13): 40.96330059549826, (4, 14): 68.343221597794, (4, 15): 31.75244100497214, (4, 16): 45.52551047270715, (4, 17): 51.86906863617942, (4, 18): 47.69125785634791, (4, 19): 60.37924215781275, (4, 20): 73.09019232559207, (4, 21): 61.53148491738271, (4, 22): 58.42488149018705, (4, 23): 19.28014977560312, (4, 24): 41.78340344617863, (4, 25): 48.51615011980902, (4, 26): 57.5660748379786, (4, 27): 47.44489059041926, (4, 28): 49.94887887913636, (4, 29): 68.7320861601109, (4, 30): 44.85785482641556, (5, 0): 81.33346428875116, (5, 1): 50.61215312332168, (5, 2): 59.75665905226485, (5, 3): 7.808939171823138, (5, 4): 66.88422981675282, (5, 5): 0.0, (5, 6): 56.74780109463307, (5, 7): 99.5838791689092, (5, 8): 111.8524154935159, (5, 9): 87.14485901606761, (5, 10): 90.55154228036568, (5, 11): 55.62403083354174, (5, 12): 63.11609600459167, (5, 13): 43.66904232305028, (5, 14): 48.98797886779737, (5, 15): 35.1318672922179, (5, 16): 82.09762002068445, (5, 17): 33.02683381072511, (5, 18): 38.92263669544921, (5, 19): 85.37525730164506, (5, 20): 14.19984137553302, (5, 21): 5.356333041541006, (5, 22): 33.20434765689635, (5, 23): 79.43962413768257, (5, 24): 106.9661202731161, (5, 25): 74.58286966924568, (5, 26): 83.85302675892832, (5, 27): 71.34341103134987, (5, 28): 19.72822285210631, (5, 29): 10.26604027320455, (5, 30): 60.80112783394169, (6, 0): 58.10325955071855, (6, 1): 6.510393152172984, (6, 2): 24.29447278641767, (6, 3): 64.18415489219576, (6, 4): 66.95379107387645, (6, 5): 56.74780109463307, (6, 6): 0.0, (6, 7): 82.98544683904579, (6, 8): 93.74530585178435, (6, 9): 49.12987656296335, (6, 10): 93.44897777316191, (6, 11): 61.87267061088031, (6, 12): 83.01037731899399, (6, 13): 27.843637633, (6, 14): 9.205705323311818, (6, 15): 52.661190278651, (6, 16): 44.72326090798753, (6, 17): 76.54654201568907, (6, 18): 78.78897691845731, (6, 19): 117.3576801887966, (6, 20): 70.91316073893209, (6, 21): 54.87575871323546, (6, 22): 80.80494642587742, (6, 23): 64.5166660816025, (6, 24): 89.69704943983781, (6, 25): 33.64482369625222, (6, 26): 114.9067933227509, (6, 27): 31.16319829628556, (6, 28): 43.17245459506361, (6, 29): 66.54080196951145, (6, 30): 24.94623813701948, (7, 0): 24.93349684161967, (7, 1): 85.14322756564519, (7, 2): 58.76768444781924, (7, 3): 105.8868772272847, (7, 4): 34.89101542556325, (7, 5): 99.5838791689092, (7, 6): 82.98544683904579, (7, 7): 0.0, (7, 8): 12.29286515370078, (7, 9): 41.54517834819209, (7, 10): 31.70901787992576, (7, 11): 45.9775557483805, (7, 12): 55.97597523745799, (7, 13): 64.28786573011753, (7, 14): 87.7917199932963, (7, 15): 65.06446409205874, (7, 16): 43.01933878965955, (7, 17): 86.71405985344981, (7, 18): 82.28932196884928, (7, 19): 83.86902394224641, (7, 20): 107.2123177909105, (7, 21): 94.32343760830844, (7, 22): 93.24401758807868, (7, 23): 20.66445137622827, (7, 24): 7.448615656322382, (7, 25): 52.52795569987541, (7, 26): 81.14852495856262, (7, 27): 53.69084199378397, (7, 28): 81.00563079963344, (7, 29): 102.6571460571683, (7, 30): 58.05675232432767, (8, 0): 35.79225674040955, (8, 1): 96.28194984249157, (8, 2): 69.7453969679159, (8, 3): 118.1112172355688, (8, 4): 46.61117202995924, (8, 5): 111.8524154935159, (8, 6): 93.74530585178435, (8, 7): 12.29286515370078, (8, 8): 0.0, (8, 9): 49.34728937208813, (8, 10): 38.01399034958364, (8, 11): 57.87361256183598, (8, 12): 65.93762061290417, (8, 13): 76.24349066518782, (8, 14): 99.0172502341449, (8, 15): 77.24443678672448, (8, 16): 51.75028662035335, (8, 17): 98.17233042396484, (8, 18): 93.49103255343152, (8, 19): 90.9014987375859, (8, 20): 119.3215570789826, (8, 21): 106.5839863501277, (8, 22): 104.6477896559684, (8, 23): 32.88843653702435, (8, 24): 4.892704652741222, (8, 25): 62.04488851090118, (8, 26): 88.28897199123165, (8, 27): 63.59542530943708, (8, 28): 93.2982176990235, (8, 29): 114.8033122577298, (8, 30): 68.96457051482133, (9, 0): 20.95720940035056, (9, 1): 53.46575007365973, (9, 2): 29.16439550796777, (9, 3): 94.77219584140026, (9, 4): 48.00461574043358, (9, 5): 87.14485901606761, (9, 6): 49.12987656296335, (9, 7): 41.54517834819209, (9, 8): 49.34728937208813, (9, 9): 0.0, (9, 10): 65.18351644637842, (9, 11): 52.36609516370075, (9, 12): 73.27289518490228, (9, 13): 43.61802160845338, (9, 14): 56.54052373944779, (9, 15): 60.86914383643731, (9, 16): 5.109604639938621, (9, 17): 89.09375495245887, (9, 18): 87.48743838568129, (9, 19): 108.3758383364992, (9, 20): 98.94389587916196, (9, 21): 82.8216407684202, (9, 22): 95.38793430053066, (9, 23): 32.11844630124852, (9, 24): 46.43200548874117, (9, 25): 15.55672658667544, (9, 26): 105.5595882513202, (9, 27): 18.4074870781972, (9, 28): 67.60196724868281, (9, 29): 93.96931534199834, (9, 30): 28.08439626302673, (10, 0): 44.30693243487325, (10, 1): 93.41203045812095, (10, 2): 70.37462596056518, (10, 3): 95.14885933871754, (10, 4): 27.19010482767081, (10, 5): 90.55154228036568, (10, 6): 93.44897777316191, (10, 7): 31.70901787992576, (10, 8): 38.01399034958364, (10, 9): 65.18351644637842, (10, 10): 0.0, (10, 11): 36.31533257988583, (10, 12): 32.09702447292722, (10, 13): 68.10447165625457, (10, 14): 95.35938864469541, (10, 15): 56.24824930819359, (10, 16): 64.49192720481457, (10, 17): 68.40072524940831, (10, 18): 62.56323364424886, (10, 19): 52.89875332012311, (10, 20): 94.22492356261691, (10, 21): 85.24861104200319, (10, 22): 74.28032744572076, (10, 23): 33.37926397810601, (10, 24): 34.69604369873512, (10, 25): 70.65450288152209, (10, 26): 50.27639823329906, (10, 27): 70.41801939334636, (10, 28): 75.50402105375167, (10, 29): 90.45360821580199, (10, 30): 70.10810170583717, (11, 0): 35.69656644012649, (11, 1): 60.41791506248253, (11, 2): 42.38364911591653, (11, 3): 61.13711280621809, (11, 4): 11.42793537692121, (11, 5): 55.62403083354174, (11, 6): 61.87267061088031, (11, 7): 45.9775557483805, (11, 8): 57.87361256183598, (11, 9): 52.36609516370075, (11, 10): 36.31533257988583, (11, 11): 0.0, (11, 12): 22.55604773937714, (11, 13): 34.41473226599162, (11, 14): 61.86444187926989, (11, 15): 20.53654894564452, (11, 16): 48.96716519888204, (11, 17): 41.31274223832322, (11, 18): 37.74640615522793, (11, 19): 58.50179433752322, (11, 20): 61.66706121876173, (11, 21): 50.2677267256203, (11, 22): 47.9146455611701, (11, 23): 28.39187248868814, (11, 24): 53.01745690216725, (11, 25): 49.39888292477868, (11, 26): 55.79464465672276, (11, 27): 47.63211736288475, (11, 28): 39.31984975008923, (11, 29): 57.30450721856972, (11, 30): 42.58415842242506, (12, 0): 54.37986486349558, (12, 1): 80.7794167858505, (12, 2): 64.81288265101328, (12, 3): 66.37001665418006, (12, 4): 25.64927984944411, (12, 5): 63.11609600459167, (12, 6): 83.01037731899399, (12, 7): 55.97597523745799, (12, 8): 65.93762061290417, (12, 9): 73.27289518490228, (12, 10): 32.09702447292722, (12, 11): 22.55604773937714, (12, 12): 0.0, (12, 13): 55.17082540850451, (12, 14): 81.81654164389097, (12, 15): 33.44776942864165, (12, 16): 70.39227940230528, (12, 17): 36.83152808513733, (12, 18): 30.69724252008502, (12, 19): 35.96620133051238, (12, 20): 64.21838237304732, (12, 21): 58.12946371641274, (12, 22): 42.4137622490554, (12, 23): 44.54870218804544, (12, 24): 61.59115193148731, (12, 25): 71.76298042723657, (12, 26): 33.24555285126252, (12, 27): 70.1103906136027, (12, 28): 52.24848817157623, (12, 29): 61.00903015802272, (12, 30): 65.05728900186352, (13, 0): 41.58352747988214, (13, 1): 26.0037326595388, (13, 2): 16.62296486099018, (13, 3): 51.3841511593312, (13, 4): 40.96330059549826, (13, 5): 43.66904232305028, (13, 6): 27.843637633, (13, 7): 64.28786573011753, (13, 8): 76.24349066518782, (13, 9): 43.61802160845338, (13, 10): 68.10447165625457, (13, 11): 34.41473226599162, (13, 12): 55.17082540850451, (13, 13): 0.0, (13, 14): 27.54190861886291, (13, 15): 25.95837615615584, (13, 16): 38.5343092167234, (13, 17): 52.79189721229156, (13, 18): 53.69634868609561, (13, 19): 89.67567946552815, (13, 20): 56.10803256656771, (13, 21): 39.61132166778867, (13, 22): 58.10040304099702, (13, 23): 43.85048232103134, (13, 24): 71.6233776733202, (13, 25): 31.08344890010711, (13, 26): 87.18672567790502, (13, 27): 27.89513919382773, (13, 28): 24.50138667642051, (13, 29): 51.1629165989993, (13, 30): 17.58254758686464, (14, 0): 63.22608949159894, (14, 1): 3.113265329732273, (14, 2): 29.39014281753258, (14, 3): 56.19601264523872, (14, 4): 68.343221597794, (14, 5): 48.98797886779737, (14, 6): 9.205705323311818, (14, 7): 87.7917199932963, (14, 8): 99.0172502341449, (14, 9): 56.54052373944779, (14, 10): 95.35938864469541, (14, 11): 61.86444187926989, (14, 12): 81.81654164389097, (14, 13): 27.54190861886291, (14, 14): 0.0, (14, 15): 49.81852331663735, (14, 16): 51.87278038557298, (14, 17): 71.3987571093486, (14, 18): 74.28073570803753, (14, 19): 115.0332861943722, (14, 20): 63.18640448399107, (14, 21): 47.64015334180236, (14, 22): 75.14164052677495, (14, 23): 68.43387568771578, (14, 24): 94.76029399571664, (14, 25): 40.9901086467553, (14, 26): 112.6989290454508, (14, 27): 38.20025808902935, (14, 28): 37.44731949004549, (14, 29): 59.01660355262862, (14, 30): 30.25878186548364, (15, 0): 49.61131461894087, (15, 1): 49.27942909127728, (15, 2): 40.5504620323308, (15, 3): 40.93322771849819, (15, 4): 31.75244100497214, (15, 5): 35.1318672922179, (15, 6): 52.661190278651, (15, 7): 65.06446409205874, (15, 8): 77.24443678672448, (15, 9): 60.86914383643731, (15, 10): 56.24824930819359, (15, 11): 20.53654894564452, (15, 12): 33.44776942864165, (15, 13): 25.95837615615584, (15, 14): 49.81852331663735, (15, 15): 0.0, (15, 16): 56.36949168075934, (15, 17): 28.51164205365621, (15, 18): 28.20624494085153, (15, 19): 65.21954692455388, (15, 20): 42.24801724603707, (15, 21): 29.77911233850329, (15, 22): 34.61061180656941, (15, 23): 45.57695023654084, (15, 24): 72.3523182139873, (15, 25): 52.59751238788923, (15, 26): 62.90704488441602, (15, 27): 49.87890208955937, (15, 28): 19.50941653991474, (15, 29): 37.61472344291401, (15, 30): 41.23702167757114, (16, 0): 20.32108747152227, (16, 1): 48.81997083463079, (16, 2): 24.11199045103866, (16, 3): 89.74058376316498, (16, 4): 45.52551047270715, (16, 5): 82.09762002068445, (16, 6): 44.72326090798753, (16, 7): 43.01933878965955, (16, 8): 51.75028662035335, (16, 9): 5.109604639938621, (16, 10): 64.49192720481457, (16, 11): 48.96716519888204, (16, 12): 70.39227940230528, (16, 13): 38.5343092167234, (16, 14): 51.87278038557298, (16, 15): 56.36949168075934, (16, 16): 0.0, (16, 17): 84.71951936437645, (16, 18): 83.32418018348675, (16, 19): 105.8391197996083, (16, 20): 93.98461885671739, (16, 21): 77.80893718244636, (16, 22): 90.95340025793048, (16, 23): 31.12388480220019, (16, 24): 48.47921967880202, (16, 25): 11.10164314025104, (16, 26): 103.0354084840184, (16, 27): 13.67403033675957, (16, 28): 62.58856452509825, (16, 29): 89.01004551583816, (16, 30): 23.03691772924323, (17, 0): 75.91772544627725, (17, 1): 71.8035872245565, (17, 2): 68.53018607468915, (17, 3): 33.20647507300442, (17, 4): 51.86906863617942, (17, 5): 33.02683381072511, (17, 6): 76.54654201568907, (17, 7): 86.71405985344981, (17, 8): 98.17233042396484, (17, 9): 89.09375495245887, (17, 10): 68.40072524940831, (17, 11): 41.31274223832322, (17, 12): 36.83152808513733, (17, 13): 52.79189721229156, (17, 14): 71.3987571093486, (17, 15): 28.51164205365621, (17, 16): 84.71951936437645, (17, 17): 0.0, (17, 18): 6.652821752776879, (17, 19): 52.53032758751132, (17, 20): 28.97683074065396, (17, 21): 29.66515266928297, (17, 22): 6.605542964298084, (17, 23): 69.6619289599058, (17, 24): 93.42442048339224, (17, 25): 81.07434770269926, (17, 26): 51.15698735687315, (17, 27): 78.30560341734332, (17, 28): 34.00630822529514, (17, 29): 27.03079565263886, (17, 30): 69.29728620106357, (18, 0): 73.09188460862043, (18, 1): 74.42818489259183, (18, 2): 68.75419480709326, (18, 3): 39.62692574005803, (18, 4): 47.69125785634791, (18, 5): 38.92263669544921, (18, 6): 78.78897691845731, (18, 7): 82.28932196884928, (18, 8): 93.49103255343152, (18, 9): 87.48743838568129, (18, 10): 62.56323364424886, (18, 11): 37.74640615522793, (18, 12): 30.69724252008502, (18, 13): 53.69634868609561, (18, 14): 74.28073570803753, (18, 15): 28.20624494085153, (18, 16): 83.32418018348675, (18, 17): 6.652821752776879, (18, 18): 0.0, (18, 19): 46.45311337271954, (18, 20): 35.61107498481665, (18, 21): 35.15900685167128, (18, 22): 11.72559447174251, (18, 23): 66.09731706707215, (18, 24): 88.80946365079055, (18, 25): 80.52755361210893, (18, 26): 44.95207032046039, (18, 27): 77.91339816167367, (18, 28): 37.36994502691879, (18, 29): 33.52165337287808, (18, 30): 69.4431738467878, (19, 0): 88.51962852882119, (19, 1): 114.4084915260553, (19, 2): 100.5523952857347, (19, 3): 85.630338167199, (19, 4): 60.37924215781275, (19, 5): 85.37525730164506, (19, 6): 117.3576801887966, (19, 7): 83.86902394224641, (19, 8): 90.9014987375859, (19, 9): 108.3758383364992, (19, 10): 52.89875332012311, (19, 11): 58.50179433752322, (19, 12): 35.96620133051238, (19, 13): 89.67567946552815, (19, 14): 115.0332861943722, (19, 15): 65.21954692455388, (19, 16): 105.8391197996083, (19, 17): 52.53032758751132, (19, 18): 46.45311337271954, (19, 19): 0.0, (19, 20): 80.61436195672283, (19, 21): 81.51944286140964, (19, 22): 54.27489606514022, (19, 23): 77.840215075864, (19, 24): 87.5475418280695, (19, 25): 107.6944325222518, (19, 26): 2.826410090306099, (19, 27): 106.0742265163458, (19, 28): 81.09506629887129, (19, 29): 79.37145591438703, (19, 30): 100.8464185090818, (20, 0): 91.10283427219564, (20, 1): 64.80427715708021, (20, 2): 72.56664525527324, (20, 3): 7.686746219382752, (20, 4): 73.09019232559207, (20, 5): 14.19984137553302, (20, 6): 70.91316073893209, (20, 7): 107.2123177909105, (20, 8): 119.3215570789826, (20, 9): 98.94389587916196, (20, 10): 94.22492356261691, (20, 11): 61.66706121876173, (20, 12): 64.21838237304732, (20, 13): 56.10803256656771, (20, 14): 63.18640448399107, (20, 15): 42.24801724603707, (20, 16): 93.98461885671739, (20, 17): 28.97683074065396, (20, 18): 35.61107498481665, (20, 19): 80.61436195672283, (20, 20): 0.0, (20, 21): 16.69468058730272, (20, 22): 26.34720139505492, (20, 23): 87.80923952169482, (20, 24): 114.4364339744446, (20, 25): 87.19145045780438, (20, 26): 79.50030279737544, (20, 27): 83.9983990976576, (20, 28): 31.60706699881747, (20, 29): 4.974683696459445, (20, 30): 73.57766044212664, (21, 0): 76.37125555017094, (21, 1): 48.97717343185385, (21, 2): 55.96514573763716, (21, 3): 12.06607945067965, (21, 4): 61.53148491738271, (21, 5): 5.356333041541006, (21, 6): 54.87575871323546, (21, 7): 94.32343760830844, (21, 8): 106.5839863501277, (21, 9): 82.8216407684202, (21, 10): 85.24861104200319, (21, 11): 50.2677267256203, (21, 12): 58.12946371641274, (21, 13): 39.61132166778867, (21, 14): 47.64015334180236, (21, 15): 29.77911233850329, (21, 16): 77.80893718244636, (21, 17): 29.66515266928297, (21, 18): 35.15900685167128, (21, 19): 81.51944286140964, (21, 20): 16.69468058730272, (21, 21): 0.0, (21, 22): 30.77716287659161, (21, 23): 74.2425663420096, (21, 24): 101.6956351694779, (21, 25): 70.67066031600207, (21, 26): 79.89317293750032, (21, 27): 67.45792484393249, (21, 28): 15.22046497946689, (21, 29): 11.91069930740501, (21, 30): 56.98725888988128, (22, 0): 82.47895112783064, (22, 1): 75.77048647163404, (22, 2): 74.12790123923762, (22, 3): 31.82329443713265, (22, 4): 58.42488149018705, (22, 5): 33.20434765689635, (22, 6): 80.80494642587742, (22, 7): 93.24401758807868, (22, 8): 104.6477896559684, (22, 9): 95.38793430053066, (22, 10): 74.28032744572076, (22, 11): 47.9146455611701, (22, 12): 42.4137622490554, (22, 13): 58.10040304099702, (22, 14): 75.14164052677495, (22, 15): 34.61061180656941, (22, 16): 90.95340025793048, (22, 17): 6.605542964298084, (22, 18): 11.72559447174251, (22, 19): 54.27489606514022, (22, 20): 26.34720139505492, (22, 21): 30.77716287659161, (22, 22): 0.0, (22, 23): 76.26733480572481, (22, 24): 99.91536781412742, (22, 25): 86.99734236640882, (22, 26): 53.20702180913084, (22, 27): 84.1676511965907, (22, 28): 37.74531729826838, (22, 29): 25.51204618331294, (22, 30): 74.93167017575166, (23, 0): 11.18417807011642, (23, 1): 65.95793143259671, (23, 2): 40.29203002379723, (23, 3): 85.98764924591875, (23, 4): 19.28014977560312, (23, 5): 79.43962413768257, (23, 6): 64.5166660816025, (23, 7): 20.66445137622827, (23, 8): 32.88843653702435, (23, 9): 32.11844630124852, (23, 10): 33.37926397810601, (23, 11): 28.39187248868814, (23, 12): 44.54870218804544, (23, 13): 43.85048232103134, (23, 14): 68.43387568771578, (23, 15): 45.57695023654084, (23, 16): 31.12388480220019, (23, 17): 69.6619289599058, (23, 18): 66.09731706707215, (23, 19): 77.840215075864, (23, 20): 87.80923952169482, (23, 21): 74.2425663420096, (23, 22): 76.26733480572481, (23, 23): 0.0, (23, 24): 28.10257174820367, (23, 25): 37.71922768575806, (23, 26): 75.01470490000527, (23, 27): 37.89194894104858, (23, 28): 60.56243484289395, (23, 29): 83.1201640680517, (23, 30): 39.75494519774219, (24, 0): 31.61093949395119, (24, 1): 92.06396367177484, (24, 2): 65.58342936374734, (24, 3): 113.2187394620523, (24, 4): 41.78340344617863, (24, 5): 106.9661202731161, (24, 6): 89.69704943983781, (24, 7): 7.448615656322382, (24, 8): 4.892704652741222, (24, 9): 46.43200548874117, (24, 10): 34.69604369873512, (24, 11): 53.01745690216725, (24, 12): 61.59115193148731, (24, 13): 71.6233776733202, (24, 14): 94.76029399571664, (24, 15): 72.3523182139873, (24, 16): 48.47921967880202, (24, 17): 93.42442048339224, (24, 18): 88.80946365079055, (24, 19): 87.5475418280695, (24, 20): 114.4364339744446, (24, 21): 101.6956351694779, (24, 22): 99.91536781412742, (24, 23): 28.10257174820367, (24, 24): 0.0, (24, 25): 58.48810481214215, (24, 26): 84.89366862859394, (24, 27): 59.88198925546257, (24, 28): 88.44002711715271, (24, 29): 109.914056099332, (24, 30): 64.83254759507068, (25, 0): 28.21843465990575, (25, 1): 37.9116173230029, (25, 2): 14.92068193493168, (25, 3): 82.3478201218962, (25, 4): 48.51615011980902, (25, 5): 74.58286966924568, (25, 6): 33.64482369625222, (25, 7): 52.52795569987541, (25, 8): 62.04488851090118, (25, 9): 15.55672658667544, (25, 10): 70.65450288152209, (25, 11): 49.39888292477868, (25, 12): 71.76298042723657, (25, 13): 31.08344890010711, (25, 14): 40.9901086467553, (25, 15): 52.59751238788923, (25, 16): 11.10164314025104, (25, 17): 81.07434770269926, (25, 18): 80.52755361210893, (25, 19): 107.6944325222518, (25, 20): 87.19145045780438, (25, 21): 70.67066031600207, (25, 22): 86.99734236640882, (25, 23): 37.71922768575806, (25, 24): 58.48810481214215, (25, 25): 0.0, (25, 26): 104.9429084269878, (25, 27): 3.268228219381483, (25, 28): 55.58457551704125, (25, 29): 82.2450035403319, (25, 30): 13.84694890671791, (26, 0): 85.69355794009749, (26, 1): 112.032232254927, (26, 2): 97.9058010951774, (26, 3): 84.33338789243207, (26, 4): 57.5660748379786, (26, 5): 83.85302675892832, (26, 6): 114.9067933227509, (26, 7): 81.14852495856262, (26, 8): 88.28897199123165, (26, 9): 105.5595882513202, (26, 10): 50.27639823329906, (26, 11): 55.79464465672276, (26, 12): 33.24555285126252, (26, 13): 87.18672567790502, (26, 14): 112.6989290454508, (26, 15): 62.90704488441602, (26, 16): 103.0354084840184, (26, 17): 51.15698735687315, (26, 18): 44.95207032046039, (26, 19): 2.826410090306099, (26, 20): 79.50030279737544, (26, 21): 79.89317293750032, (26, 22): 53.20702180913084, (26, 23): 75.01470490000527, (26, 24): 84.89366862859394, (26, 25): 104.9429084269878, (26, 26): 0.0, (26, 27): 103.3411201990413, (26, 28): 79.06253670642778, (26, 29): 78.10257624763943, (26, 30): 98.18947804347233, (27, 0): 29.01611405522948, (27, 1): 35.1459440568528, (27, 2): 11.65422795577537, (27, 3): 79.11307874919765, (27, 4): 47.44489059041926, (27, 5): 71.34341103134987, (27, 6): 31.16319829628556, (27, 7): 53.69084199378397, (27, 8): 63.59542530943708, (27, 9): 18.4074870781972, (27, 10): 70.41801939334636, (27, 11): 47.63211736288475, (27, 12): 70.1103906136027, (27, 13): 27.89513919382773, (27, 14): 38.20025808902935, (27, 15): 49.87890208955937, (27, 16): 13.67403033675957, (27, 17): 78.30560341734332, (27, 18): 77.91339816167367, (27, 19): 106.0742265163458, (27, 20): 83.9983990976576, (27, 21): 67.45792484393249, (27, 22): 84.1676511965907, (27, 23): 37.89194894104858, (27, 24): 59.88198925546257, (27, 25): 3.268228219381483, (27, 26): 103.3411201990413, (27, 27): 0.0, (27, 28): 52.39435743019364, (27, 29): 79.05663951220352, (27, 30): 10.58253264463955, (28, 0): 61.7892435125685, (28, 1): 38.02569128225791, (28, 2): 41.00424674254285, (28, 3): 27.20319516227938, (28, 4): 49.94887887913636, (28, 5): 19.72822285210631, (28, 6): 43.17245459506361, (28, 7): 81.00563079963344, (28, 8): 93.2982176990235, (28, 9): 67.60196724868281, (28, 10): 75.50402105375167, (28, 11): 39.31984975008923, (28, 12): 52.24848817157623, (28, 13): 24.50138667642051, (28, 14): 37.44731949004549, (28, 15): 19.50941653991474, (28, 16): 62.58856452509825, (28, 17): 34.00630822529514, (28, 18): 37.36994502691879, (28, 19): 81.09506629887129, (28, 20): 31.60706699881747, (28, 21): 15.22046497946689, (28, 22): 37.74531729826838, (28, 23): 60.56243484289395, (28, 24): 88.44002711715271, (28, 25): 55.58457551704125, (28, 26): 79.06253670642778, (28, 27): 52.39435743019364, (28, 28): 0.0, (28, 29): 26.66229578394478, (28, 30): 42.00331720301534, (29, 0): 86.24514613992763, (29, 1): 60.52029218105164, (29, 2): 67.64471103268659, (29, 3): 6.311779922945139, (29, 4): 68.7320861601109, (29, 5): 10.26604027320455, (29, 6): 66.54080196951145, (29, 7): 102.6571460571683, (29, 8): 114.8033122577298, (29, 9): 93.96931534199834, (29, 10): 90.45360821580199, (29, 11): 57.30450721856972, (29, 12): 61.00903015802272, (29, 13): 51.1629165989993, (29, 14): 59.01660355262862, (29, 15): 37.61472344291401, (29, 16): 89.01004551583816, (29, 17): 27.03079565263886, (29, 18): 33.52165337287808, (29, 19): 79.37145591438703, (29, 20): 4.974683696459445, (29, 21): 11.91069930740501, (29, 22): 25.51204618331294, (29, 23): 83.1201640680517, (29, 24): 109.914056099332, (29, 25): 82.2450035403319, (29, 26): 78.10257624763943, (29, 27): 79.05663951220352, (29, 28): 26.66229578394478, (29, 29): 0.0, (29, 30): 68.65158416886743, (30, 0): 33.22160817810058, (30, 1): 27.40873713416465, (30, 2): 1.090121073984672, (30, 3): 68.58100384198583, (30, 4): 44.85785482641556, (30, 5): 60.80112783394169, (30, 6): 24.94623813701948, (30, 7): 58.05675232432767, (30, 8): 68.96457051482133, (30, 9): 28.08439626302673, (30, 10): 70.10810170583717, (30, 11): 42.58415842242506, (30, 12): 65.05728900186352, (30, 13): 17.58254758686464, (30, 14): 30.25878186548364, (30, 15): 41.23702167757114, (30, 16): 23.03691772924323, (30, 17): 69.29728620106357, (30, 18): 69.4431738467878, (30, 19): 100.8464185090818, (30, 20): 73.57766044212664, (30, 21): 56.98725888988128, (30, 22): 74.93167017575166, (30, 23): 39.75494519774219, (30, 24): 64.83254759507068, (30, 25): 13.84694890671791, (30, 26): 98.18947804347233, (30, 27): 10.58253264463955, (30, 28): 42.00331720301534, (30, 29): 68.65158416886743, (30, 30): 0.0}
    capacity = 30
    speed = 60
    unload_t = 10

    obj, runtime = solve_routing(
        S, V,
        distance, demand,
        capacity, speed,
        unload_t
    )
    print(f"Obj value = {obj:.1f} min, solve time = {runtime:.3f} s")